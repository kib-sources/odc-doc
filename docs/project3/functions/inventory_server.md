---
title: inventory (сервер)
---
# inventory

Функция 
[сервера](../architecture/bank/server.md).

Данная функция вызывается из 
[одноимённой функции кошелька](inventory.md)

Необходима для двух целей:
1. Для пользователей: дополнительное подтверждение offline платежа.
2. Для банка-эмитента: история движения каждой банкноты в системе для дальнейшего анализа.


## Алгоритм

В рамках каждой полученной банкноты:

1. Провести процедуру [validation](validation.md). Если не корректно -- вернуть ошибку
2. Проверить что нет "штанов", вызванная деятельностью [фальшивомонетчиков](../information-security/counterfeiters.md)
3. Подписать все блоки. См. [sign_hash_bank](sign-hash-bank.md)
4. Сохранить их в [системе анализа](../architecture/bank/analysis.md)
5. Отправить подписанные блоки кошельку

:::tip[Обратите внимание]
В случае "штанов"
легитимными будут те банкноты,
которые **первые** отправили 
на сервер
свои банкноты
на дополнительную проверку.

Таким образом
пользователям offline кошельков
для минимизации рисков
выгодно как можно быстрее выйти на инвентаризацию.
:::

