---
sidebar_position: 2
---
# Кошелёк 

Кошелёк -- это Android\iOS приложение
`odc-time-wallet-android` / `odc-time-wallet-ios`.
Далее будем называть его 
просто **Кошелёк**.

Так же есть Онлайн-кошелёк
`odc-online-time-wallet`.
Далее будем называть 
**Online кошелёк**.

Онлайн кошельки, вместе со своими `spk`
ключами доступны только в режиме онлайн.
В случае отсутствия сети доступ к ним закрыт.



При создании каждого **кошелька**
ему создаётся пара 
в **online кошелёк**.

Из онлайн кошельков списываются деньги 
по ваучеру (долгу)
или при переводе денег между
**кошельком** и его парой -- **онлайн кошельком**.

## Архитектура Кошелька 

TODO


## Создание нового кошелька.

Пользователь скачивает приложение,
приложение устанавливает 
`application_id` -- уникальное ID приложения (установки).

На самом приложении генерируются 
ключи `spk` / `sok`.

:::danger[Замечение]
В рамках 
**ODC 2.5**
не решается проблема
доверенной среды кошелька.

Мы "джентельмены" и `spk` / `sok`
храняться на Android\iOS,
а не в SIM карте. 

Это не является проблемой Time Money,
т.к. мошенничество постфактум может быть легко обнаружено

Cм. подробнее: ***TODO написать статью отдельную***
:::


С помощью  POST запроса API
`wallet\init`
отправляется на сервер
`application_id` и `sok`.

:::note[Для информации]
Если пользователь потерял телефон и повторно регистрирует
новое устройство, то отправляется POST 
запрос на ручку 
`wallet\restore`
и отправляет на сервер
`application_id`, `sok`, `wid`.
Подробнее: **TODO**
:::

Происходит регистрация кошелька 
со статусом 
`requires_confirmation`.
Поле `parent` равно `Null`.
Случайным образом присваивается
одноразовый пароль из 7 цифр
`confirmation_number`.
Поле 
`confirmation_attempts` (количество попыток ввода)
равно `0`.

Значение `confirmation_number`
высылается приложению.

Новый пользователь любым каналом связи
(мы считаем, что опционально устно при очной встрече)
сообщает  `confirmation_number`
любому ранее зарегестрированному
пользователю.

:::tip[Идея от Екатерины]
Есть идея, чтобы не было мёртвых душ.

Правило:
1. НЕЛЬЗЯ пригласить никого без выделения из своего кошелька 1 часа (или более),
2. Одно из двух:
* Для того чтобы пригласить, вклад кошелька должен быть не менее 10 часов. (Павел С. -- за.)
* Кому-то оказал услугу в размере N часов (вклад 2) (Павел С -- против)

Дмитрий Т.: "Надо подумать..."

***Пока это думаем. Сейчас в описании этого нет***
:::


Уже зарегестрированный кошелёк,
нажимает кнопку 
`пригласить`
и набирает 7 цифр.

Новый кошелёк 
получает свой `wid`
и его статус переходи в `active`.

